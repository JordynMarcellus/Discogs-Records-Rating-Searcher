var myApp={};myApp.key="mbVHEypGaMdeyTMrYYHn",myApp.secret="riOpCutFddLUkrxCftUkCWNKekDbpVpL",myApp.albumWrapper=document.getElementById("album-wrapper"),myApp.artistBox=document.getElementById("artist-box"),myApp.slidingModal=document.getElementById("sliding-modal"),myApp.init=function(){document.getElementById("discogs_search").addEventListener("submit",function(e){e.preventDefault(),myApp.searchTerm=document.getElementById("artist-search").value,myApp.getArtists(myApp.searchTerm)}),document.getElementById("close-btn").addEventListener("click",function(e){myApp.slidingModal.style.right="-50vw"})},myApp.searchURL="https://api.discogs.com/database/search",myApp.artistURL="https://api.discogs.com/artists/",myApp.releaseURL="https://api.discogs.com/releases/",myApp.getArtists=function(e){$.ajax({url:myApp.searchURL,type:"GET",dataType:"json",data:{key:myApp.key,secret:myApp.secret,q:e},success:function(e){myApp.albumArray=[],myApp.getArtistInfo(e.results[0].id),myApp.getReleases(e.results[0].id)}})},myApp.getArtistInfo=function(e){$.ajax({url:myApp.artistURL+e,type:"GET",dataType:"json",success:function(e){myApp.displayArtists(e)}})},myApp.displayArtists=function(e){myApp.artistBox.innerHTML="",myApp.albumWrapper.innerHTML="";var t="<article class='artist-name'><h1>"+e.name+"</h1></article>";myApp.artistBox.innerHTML=t},myApp.getReleases=function(e){$.ajax({url:myApp.artistURL+e+"/releases",type:"GET",dataType:"json",success:function(e){console.log(e),e.releases?(e.releases.sort(myApp.sortReleases),e.releases.forEach(myApp.getReleaseInfo)):console.log("hey we got an error here...",e)}})},myApp.getReleaseInfo=function(e,t,a){if(e.main_release){var s=null;s=e.main_release,$.ajax({url:myApp.releaseURL+s,type:"GET",dataType:"json",success:function(e){myApp.albumArray.push(e),myApp.displayAlbums(e)}})}},myApp.displayAlbums=function(e){var t=myApp.albumArray.length-1,a=e.community.rating,s="<article id='album-info-box_"+t+"' class='album-info-box' data-index="+t+">";s+="<h3 class='album-year'>"+e.title+"</h3>",s+="<p class='album-rating'>Rating: "+a.average+"/5 ("+a.count+" votes)</p>",s+="<p class='album-year'>"+e.year+"</p>",s+="<button id='learn-more-btn_"+t+"' data-index="+t+" class='learn-more-btn btn'>learn more</button></article>",myApp.albumWrapper.innerHTML+=s},myApp.sortReleases=function(e,t){return e.year-t.year},myApp.makeVideoGallery=function(e,t,a){var s=e.uri.split("v=");document.getElementById("video-gallery").innerHTML+="<div class='gallery-item gallery-item-"+t+"' style='left:"+100*t+"%'><div class='video_wrapper'><span class='left-arrow'></span><iframe src='https://www.youtube.com/embed/"+s[1]+"' frameborder='0' allowfullscreen></iframe><span class='right-arrow'></span></div><h2 class='video_title'>"+e.title+"</h2></div>"},myApp.fillTracklist=function(e,t,a){document.getElementById("album-tracklist").innerHTML+="<li>"+e.title+"</li>"},myApp.showMoreinfo=function(e){myApp.modal=myApp.slidingModal.children[0],console.log(e),e.videos&&e.videos.forEach(myApp.makeVideoGallery),document.getElementById("album-title").textContent=e.title,document.getElementById("album-label").textContent=e.labels[0].name,e.tracklist.forEach(myApp.fillTracklist),myApp.slidingModal.style.right="0"},document.querySelector("body").addEventListener("click",function(e){var t=event.target;t.className.match("learn-more-btn")&&myApp.showMoreinfo(myApp.albumArray[t.dataset.index])}),document.addEventListener("DOMContentLoaded",function(e){!function(){myApp.init()}()});